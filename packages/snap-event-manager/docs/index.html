<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@searchspring/snap-event-manager</title><meta name="description" content="Documentation for @searchspring/snap-event-manager"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@searchspring/snap-event-manager</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>@searchspring/snap-event-manager</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#snap-event-manager" id="snap-event-manager" style="color: inherit; text-decoration: none;">
  <h1>Snap Event Manager</h1>
</a>
<p><a href="https://www.npmjs.com/package/@searchspring/snap-event-manager"><img alt="NPM Status" src="https://img.shields.io/npm/v/@searchspring/snap-event-manager.svg?style=flat"></a></p>
<p>The Snap Event Manager is used to create events and attach middleware to them.</p>
<p>When used as a service of a controller it allows you to hook into controller events at critical times in the life cycle. It also allows for custom events to be used throughout your implementation.</p>

<a href="#dependency" id="dependency" style="color: inherit; text-decoration: none;">
  <h2>Dependency</h2>
</a>
<p>Snap Event Manager is a dependency of <a href="https://github.com/searchspring/snap/tree/main/packages/snap-controller">@searchspring/snap-controller</a> <a href="https://www.npmjs.com/package/@searchspring/snap-controller"><img alt="NPM Status" src="https://img.shields.io/npm/v/@searchspring/snap-controller.svg?style=flat"></a></p>
<details>
    <summary>Package dependencies hierarchy</summary>
    <br/>
    <img src="https://github.com/searchspring/snap/blob/main/images/snap-dependencies.png?raw=true"/>
</details>
<br>


<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
  <h2>Installation</h2>
</a>
<pre><code class="language-bash"><span class="hl-0">npm install --save @searchspring/snap-event-manager</span>
</code></pre>

<a href="#import" id="import" style="color: inherit; text-decoration: none;">
  <h2>Import</h2>
</a>
<pre><code class="language-typescript"><span class="hl-1">import</span><span class="hl-0"> { </span><span class="hl-2">EventManager</span><span class="hl-0"> } </span><span class="hl-1">from</span><span class="hl-0"> </span><span class="hl-3">&#39;@searchspring/snap-event-manager&#39;</span><span class="hl-0">;</span>
</code></pre>

<a href="#controller-usage" id="controller-usage" style="color: inherit; text-decoration: none;">
  <h2>Controller usage</h2>
</a>
<p>Snap Event Manager is a dependency of Snap Controller and it is recommended to use methods of the controller to attach events to the EventManager. Additionally, different events exist for the different controllers - see the Controller documentation for more details.</p>

<a href="#standalone-usage" id="standalone-usage" style="color: inherit; text-decoration: none;">
  <h2>Standalone usage</h2>
</a>

<a href="#on-method" id="on-method" style="color: inherit; text-decoration: none;">
  <h3><code>on</code> method</h3>
</a>
<p>Used to attach middleware to an event. If the event name previously had middleware attached, it will add to the middleware stack.</p>
<pre><code class="language-typescript"><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-5">eventManager</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-6">EventManager</span><span class="hl-0">();</span><br/><br/><span class="hl-2">eventManager</span><span class="hl-0">.</span><span class="hl-6">on</span><span class="hl-0">(</span><span class="hl-3">&#39;interestingEvent&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-2">eventData</span><span class="hl-0">, </span><span class="hl-2">next</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-7">// do something with the eventData</span><br/><br/><span class="hl-0">    </span><span class="hl-7">// pass control to the next middleware attached to the event</span><br/><span class="hl-0">    </span><span class="hl-1">await</span><span class="hl-0"> </span><span class="hl-6">next</span><span class="hl-0">();</span><br/><br/><span class="hl-0">    </span><span class="hl-7">// do something after other middleware has fired</span><br/><span class="hl-0">});</span>
</code></pre>
<p>If a middleware returns <code>false</code> the entire middleware flow is interrupted and any remaining middleware is not executed.</p>

<a href="#fire-method" id="fire-method" style="color: inherit; text-decoration: none;">
  <h3><code>fire</code> method</h3>
</a>
<p>Invoke custom event. Data passed into the second parameter gets handed off to the middleware attached with the <code>on</code> method.</p>
<pre><code class="language-typescript"><span class="hl-2">eventManager</span><span class="hl-0">.</span><span class="hl-6">fire</span><span class="hl-0">(</span><span class="hl-3">&#39;interestingEvent&#39;</span><span class="hl-0">, { </span><span class="hl-2">data:</span><span class="hl-0"> { </span><span class="hl-2">some:</span><span class="hl-0"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-0"> } });</span>
</code></pre>

<a href="#middleware" id="middleware" style="color: inherit; text-decoration: none;">
  <h2>Middleware</h2>
</a>
<p>Middleware provide a way for mutating or modifying the data passed in during the <code>fire</code> method.</p>

<a href="#execution-order" id="execution-order" style="color: inherit; text-decoration: none;">
  <h3>Execution order</h3>
</a>
<p>The first middleware attached with the <code>on</code> method is the first to execute. When calling <code>await next()</code>, control flows to the next attached middleware. This happens until the final middleware has been called after which control flows back up to the first middleware attached. The first middleware gets the first, and last opportunity to modify the data.</p>

<a href="#order-flow-example" id="order-flow-example" style="color: inherit; text-decoration: none;">
  <h3>Order Flow Example</h3>
</a>
<pre><code class="language-typescript"><span class="hl-2">eventManager</span><span class="hl-0">.</span><span class="hl-6">on</span><span class="hl-0">(</span><span class="hl-3">&#39;interestingEvent&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-2">data</span><span class="hl-0">, </span><span class="hl-2">next</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-2">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">&#39;first middleware start&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-1">await</span><span class="hl-0"> </span><span class="hl-6">next</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-2">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">&#39;first middleware end&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-2">eventManager</span><span class="hl-0">.</span><span class="hl-6">on</span><span class="hl-0">(</span><span class="hl-3">&#39;interestingEvent&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-2">data</span><span class="hl-0">, </span><span class="hl-2">next</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-2">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">&#39;second middleware start&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-1">await</span><span class="hl-0"> </span><span class="hl-6">next</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-2">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">&#39;second middleware end&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-2">eventManager</span><span class="hl-0">.</span><span class="hl-6">on</span><span class="hl-0">(</span><span class="hl-3">&#39;interestingEvent&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-2">data</span><span class="hl-0">, </span><span class="hl-2">next</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-2">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">&#39;third middleware start&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-1">await</span><span class="hl-0"> </span><span class="hl-6">next</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-2">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">&#39;third middleware end&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-2">eventManager</span><span class="hl-0">.</span><span class="hl-6">fire</span><span class="hl-0">(</span><span class="hl-3">&#39;interestingEvent&#39;</span><span class="hl-0">, { </span><span class="hl-2">data:</span><span class="hl-0"> { </span><span class="hl-2">some:</span><span class="hl-0"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-0"> } } );</span><br/>
</code></pre>
<p>After firing the <code>interestingEvent</code> event, the following would be displayed in the console:</p>
<pre><code class="language-text">first middleware start
second middleware start
third middleware start
third middleware end
second middleware end
first middleware end
</code></pre>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/EventManager.html" class="tsd-kind-icon">Event<wbr/>Manager</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Callback" class="tsd-kind-icon">Callback</a></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><a href="modules.html#Middleware" class="tsd-kind-icon">Middleware</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Next" class="tsd-kind-icon">Next</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>